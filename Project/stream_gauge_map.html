<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Filter symbols by toggling a list</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    </style>
    </head>
<body>
<style>
    .LegendContainer {
     position: absolute;
     bottom: 20px;
     left: 20px;
     z-index: 2;
     width: 300px;
     height: 60px;
     background: rgba(250, 247, 247, .75);
     transition: width 2s, height 2s; /* this is the time it takes for the container to transition */
     border-radius: 7px;
   }
     .descriptionPanel {
     position: absolute;
     bottom: 65px;
     left: 20px;
     z-index: 2;
     width: 300px;
     height: 60px;
     background: rgba(250, 247, 247, 0.75);
     transition: width 2s, height 2s;
     overflow: hidden;
     border-radius: 7px;
   }
   .LegendContainer:active {
     width: 240px;
     height: 250px;
   }
   .legendItem {
       margin: 0px;
       padding-left: 10px;
       display:inline-block;
       margin:auto;
       transform: translate(50%, 50%);
   }
   .layerDescription {
         color: rgb(19, 18, 18);
         margin-left: 10px;
       }
    .zero-two {
        color: #d7191c;
    }
    .two-four {
        color: #fdae61;
    }
    .four-six{
        color: #ffffbf;
    }
    .six-eight{
        color: #abdda4;
    }
    .eight-ten{
        color: #2b83ba;
    }

    .chevron {
     position: relative;
     margin-left: 45%;
     font-size: x-large;
     color: white;
   }

    
</style>
<div id="map"></div>

<div class="descriptionPanel" id="descriptionPanel" style="height: 250px;">
    <span onClick=panelSelect() id="glyph" class="chevron glyphicon glyphicon-chevron-down"></span>
    <hr/>
    <h4>WHAT AM I LOOKING AT?</h4>
    <p style="margin-left: 10px; margin-right: 10px;">
      This is a map displaying the locations of stream gauges in Oregon using data from USGS. The earliest 
      of these gauges started recording on April 1st, 1950 and the extent of records in this dataset extend to 
      March 31, 2021.  
</div>

<div class="LegendContainer">
    <div class="legendItem">
        <span class= 'zero-two'>&#11044;</span>
        <span class="layerDescription">0-19%</span>
    </div>
    <div class="legendItem">
        <span class="two-four">&#11044;</span>
        <span class="layerDescription">20-39%</span>
    </div>
    <div class="legendItem">
        <span class="four-six">&#11044;</span>
        <span class="layerDescription">40-59%</span>
    </div>
    <div class="legendItem">
        <span class="six-eight">&#11044;</span>
        <span class="layerDescription">60-79%</span>
    </div>
    <div class="legendItem">
        <span class="eight-ten">&#11044;</span>
        <span class="layerDescription">80-100%</span>
    </div>
    
</div>
<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiYW5uZWtlYiIsImEiOiJjbGc1ZGJ5a28wMXBzM21tamZnZm55c2tzIn0.LCxLkdp4WDmUB2hSvfWGtQ';
    
    // ADD THE DATA HERE (II.2)
    var bounds = [
      [- 125, 41], // southwest bounds
      [-116, 47] // northeast bounds
    ];

    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/outdoors-v12',
        center: [-120.5542, 43.8041],
        zoom: 6.5,
        minZoom: 3.8,
        maxZoom: 12,
        maxBounds: bounds

    });

    // Map's On 'load' function.
    map.on('load', () => {
    map.addSource('gages', {
    type: 'geojson',
    data: "https://annekebrouwer.github.io/Webmapping/Project/final_gages.geojson"})
    map.addLayer({
  	             id: 'marker-colors',
                 type: 'circle',
                 
  	             source: 'gages',
                 paint: {
                  'circle-radius': 8,
                  'circle-stroke-width': 2,
                  'circle-color':
                     ["step",
                        ["get", "record_extent"],   // sequential color scheme from color brewer, 5 bins
                        "#d7191c",
                        0.2,
                        "#fdae61",
                        0.4,
                        "#ffffbf",
                        0.6,
                        "#abdda4",
                        0.8,
                        "#2b83ba"
                     ],
                 'circle-stroke-color': 'black'

                 }       
                 });
                 map.on('click', 'marker-colors', (e) => {
                 const coordinates = e.features[0].geometry.coordinates.slice();
                 const properties = e.features[0].properties;

                const popupContent = `
                    <h3>${properties.STANAME}</h3>
                    <p>Start Day: ${properties.start_year}</br>
                        Record Extent: ${Math.round(properties.record_extent * 100, 2)}% </p>`
                
                        ;

    new mapboxgl.Popup()
      .setLngLat(coordinates)
      .setHTML(popupContent)
      .addTo(map);
  });
});
    // legend interaction
    var state = { panelOpen: true };

    function panelSelect(e){
    if(state.panelOpen){
        document.getElementById('descriptionPanel').style.height = '26px';
        document.getElementById('glyph').className = "chevron glyphicon glyphicon-chevron-up";
        state.panelOpen = false;
    } else {
        document.getElementById('descriptionPanel').style.height = '250px';
        document.getElementById('glyph').className = "chevron glyphicon glyphicon-chevron-down";
        state.panelOpen = true;
    }
}
                 
            



  




</script>

</body>
</html> 